<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Example</title>
    <style>
        body { margin: 0; }
        canvas { width: 100%; height: 100% }

        input { width:100px; }
    </style>

    <link rel="stylesheet" href="http://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
    <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
    <script src="http://code.jquery.com/ui/1.11.4/jquery-ui.js"></script>

</head>
<body>
    <script src="three.min.js"></script>
    <script src="OrbitControls.js"></script>
    <script src=""jquery-ui.js></script>

    <script src="data/h(2,2,2).js"></script>
    <script src="data/h(2,2,4).js"></script>
    <script src="data/z(2,2,2).js"></script>
    <script src="data/z(2,2,4).js"></script>
    <script src="data/r(2,2,2).js"></script>
    <script src="data/r(2,2,4).js"></script>
    <script>
        // select curve
        var sfc = sfc__R222;
        var curve_family = "R";
        var curve_shape = "square";

        var sel_x = 0;
        var sel_y = 0;
        var sel_z = 0;

        var num_nodes = 0;

        function update_model() {
            sfc = sfc__R222;
            if (curve_family == "R") {
              if (curve_shape == "square") sfc = sfc__R222;
              else sfc = sfc__R224;
            }
            if (curve_family == "Z") {
              if (curve_shape == "square") sfc = sfc__Z222;
              else sfc = sfc__Z224;
            }
            if (curve_family == "H") {
              if (curve_shape == "square") sfc = sfc__H222;
              else sfc = sfc__H224;
            }

            // query
            if (sel_x == 0) {
                sel_x = [sfc.bounds[0].min, sfc.bounds[0].max];
            } else {
                sel_x = [
                  Math.max(sfc.bounds[0].min, Math.min(sfc.bounds[0].max, sel_x[0])),
                  Math.min(sfc.bounds[0].max, Math.max(sfc.bounds[0].min, sel_x[1]))
                ];
            }
            if (sel_y == 0) {
                sel_y = [sfc.bounds[1].min, sfc.bounds[1].max];
            } else {
                sel_y = [
                  Math.max(sfc.bounds[1].min, Math.min(sfc.bounds[1].max, sel_y[0])),
                  Math.min(sfc.bounds[1].max, Math.max(sfc.bounds[1].min, sel_y[1]))
                ];
            }
            if (sel_z == 0) {
                sel_z = [sfc.bounds[2].min, sfc.bounds[2].max];
            } else {
                sel_z = [
                  Math.max(sfc.bounds[2].min, Math.min(sfc.bounds[2].max, sel_z[0])),
                  Math.min(sfc.bounds[2].max, Math.max(sfc.bounds[2].min, sel_z[1]))
                ];
            }

            num_nodes = 1;
            for (i=0; i<3; i++) {
                num_nodes = num_nodes * (sfc.bounds[i].max - sfc.bounds[i].min + 1);
            }

            console.log("Model:  " + sfc.name);

            rebuild();
            update_selection();
        }

        // whether to rotate automatically
        var rotate = {
          x: false,
          y: false,
          z: false
        };

        // selection ranges
        var ranges = [];
    </script>
    <script src="viz.js"></script>

<!--
    <br><input type="button" id="btn_rotate_x" value="rotate x" onclick="toggle_rotation_x()"/>
    <br><input type="button" id="btn_rotate_y" value="rotate y" onclick="toggle_rotation_y()"/>
    <br><input type="button" id="btn_rotate_z" value="rotate z" onclick="toggle_rotation_z()"/>

    <p/>
    <br><input type="button" id="btn_reset_x" value="reset x" onclick="reset_rotation_axis('x')"/>
    <br><input type="button" id="btn_reset_y" value="reset y" onclick="reset_rotation_axis('y')"/>
    <br><input type="button" id="btn_reset_z" value="reset z" onclick="reset_rotation_axis('z')"/>
-->

    <script>
    update_model();

  $(function() {
    $( "#slider-range-x" ).slider({
      range: true,
      min: sfc.bounds[0].min,
      max: sfc.bounds[0].max,
      values: [ sfc.bounds[0].min, sfc.bounds[0].max ],
      slide: function( event, ui ) {
        $( "#x-query-range" ).val( "" + ui.values[ 0 ] + " - " + ui.values[ 1 ] );
        sel_x = [ui.values[0], ui.values[1]];
        update_selection();
      }
    });
    $( "#x-query-range" ).val( "" + $( "#slider-range-x" ).slider( "values", 0 ) +
      " - " + $( "#slider-range-x" ).slider( "values", 1 ) );
  });

    $(function() {
    $( "#slider-range-y" ).slider({
      range: true,
      min: sfc.bounds[1].min,
      max: sfc.bounds[1].max,
      values: [ sfc.bounds[1].min, sfc.bounds[1].max ],
      slide: function( event, ui ) {
        $( "#y-query-range" ).val( "" + ui.values[ 0 ] + " - " + ui.values[ 1 ] );
        sel_y = [ui.values[0], ui.values[1]];
        update_selection();
      }
    });
    $( "#y-query-range" ).val( "" + $( "#slider-range-y" ).slider( "values", 0 ) +
      " - " + $( "#slider-range-y" ).slider( "values", 1 ) );
  });

  $(function() {
    $( "#slider-range-z" ).slider({
      range: true,
      min: sfc.bounds[2].min,
      max: sfc.bounds[2].max,
      values: [ sfc.bounds[2].min, sfc.bounds[2].max ],
      slide: function( event, ui ) {
        $( "#z-query-range" ).val( "" + ui.values[ 0 ] + " - " + ui.values[ 1 ] );
        sel_z = [ui.values[0], ui.values[1]];
        update_selection();
      }
    });
    $( "#z-query-range" ).val( "" + $( "#slider-range-z" ).slider( "values", 0 ) +
      " - " + $( "#slider-range-z" ).slider( "values", 1 ) );
  });

    function toggle_rectangle() {
      //console.log("checked:  " + $("#use-off-square").prop('checked'));
      if ($("#use-off-square").prop('checked')) {
        curve_shape = "rectangular";
      } else {
        curve_shape = "square";
      }
      update_model();
    }

    function switch_model() {
      curve_family = $("input[name=model-type]:checked").val();
      update_model();
    }
  </script>

    <p>
        <input type="radio" name="model-type" value="R" onclick="switch_model()" checked="true">row-major<br>
        <input type="radio" name="model-type" value="Z" onclick="switch_model()">Z-order<br>
        <input type="radio" name="model-type" value="H" onclick="switch_model()">(compact) Hilbert<br>
    </p>

    <p>
        <input type="checkbox" id="use-off-square" name="use-off-square" value="1" onclick="toggle_rectangle()">Use long-rectangle version?<br>
    </p>

    <p>
        <label for="num-ranges">Number of ranges:</label>
        <input type="text" id="num-ranges" readonly style="border:0; font-weight:bold;">
    </p>

    <p>
        <label for="range-list">Range enumeration:</label>
        <input type="text" id="range-list" readonly style="border:0; font-weight:bold; width:100%;">
    </p>

    <p>
        <label for="x-query-range">X-query range:</label>
        <input type="text" id="x-query-range" readonly style="border:0; color:#f6931f; font-weight:bold;">
    </p>
    <div id="slider-range-x" style="width:400px;"></div>

    <p>
        <label for="y-query-range">Y-query range:</label>
        <input type="text" id="y-query-range" readonly style="border:0; color:#f6931f; font-weight:bold;">
    </p>
    <div id="slider-range-y" style="width:400px;"></div>

    <p>
        <label for="z-query-range">Z-query range:</label>
        <input type="text" id="z-query-range" readonly style="border:0; color:#f6931f; font-weight:bold;">
    </p>
    <div id="slider-range-z" style="width:400px;"></div>

    <script>
        update_selection();
    </script>

</body>
</html>